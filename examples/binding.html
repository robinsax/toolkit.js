<!DOCTYPE html>
<html lang="en">
	<head>
		<script src="../toolkit.js"></script>
		<script defer>
			var tk = createToolkit({debug: true});

			var articles = [
				{
					title: 'Corporate business report 2022',
					content: 'Makin\'.',
					color: 'blue',
					comments: [
						'Nice!',
						'Wow rlly!?',
						'Lame.'
					]
				},
				{
					title: 'The environment is gone.',
					content: 'Goodbye!',
					color: 'green',
					comments: [
						'Wind enerjie.'
					]
				}
			];

			/*
				TODO:
				AJAX JSON response binding via:

				tk.request()
					.binding()
						.onto(tk('body'))
						.and()
					.sendAndBegin();
			*/

			tk.init(function(){
				tk.binding(articles)
					.onto(tk('body'))
						.tag('div')
						.placement(function(article, e){
							var binding = tk.binding.on(article);

							binding('title')
								.onto(e.append('h2'))
									.transform(function(title){
										return title.toUpperCase();
									})
								.and()
								.changed(function(d){
									tk.log('Title changed to: ' + d);
								})
							.begin();

							binding('content')
								.onto(e.append('p'))
							.begin();

							binding('color')
								.changed(function(d){
									e.css('color', d);
								})
							.begin();

							binding('comments')
								.changed(function(d){
									e.children('ul').remove();
									tk.binding(d)
										.onto(e.append('ul'))
											.tag('li')
									.begin();
								})
							.begin()
						})
					.and()
				.begin();
			});
		</script>
	</head>
	<body></body>
</html>